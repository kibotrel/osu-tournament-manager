{
  "openapi": "3.0.0",
  "info": {
    "license": {
      "name": "GNU General Public License v3.0",
      "url": "https://github.com/kibotrel/osu-tournament-manager/blob/main/LICENSE"
    },
    "title": "osu! tournament manager API",
    "version": "0.0.1"
  },
  "servers": [
    {
      "url": "https://{environment}.osu-tournament-manager.app/api/{version}",
      "variables": {
        "environment": {
          "default": "dev",
          "enum": [
            "dev",
            "production",
            "staging"
          ]
        },
        "version": {
          "default": "v1",
          "enum": [
            "v1"
          ]
        }
      }
    }
  ],
  "tags": [
    {
      "name": "Authentication",
      "description": "User session management.\n"
    },
    {
      "name": "Matches",
      "description": "Match management and related operations.\n"
    },
    {
      "name": "Public",
      "description": "Publicly available resources, no authentication required.\n"
    }
  ],
  "paths": {
    "/authentication/login": {
      "post": {
        "description": "This is where all osu! OAuth successful authentication requests are redirected to.\nIt creates a session to keep user logged-in for subsequent requests\nand a token to interact with osu! API. <b>This endpoint shouldn't be used directly.</b>\n",
        "operationId": "login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "authenticationCode": {
                    "type": "string"
                  }
                },
                "required": [
                  "authenticationCode"
                ],
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "avatarUrl": {
                      "example": "https://a.ppy.sh/3909293?1555203556.jpeg",
                      "type": "string"
                    },
                    "gameUserId": {
                      "example": 3909293,
                      "type": "integer"
                    },
                    "name": {
                      "example": "DemonWaves",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "New session created, user already exists in database."
          },
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "avatarUrl": {
                      "example": "https://a.ppy.sh/3909293?1555203556.jpeg",
                      "type": "string"
                    },
                    "gameUserId": {
                      "example": 3909293,
                      "type": "integer"
                    },
                    "name": {
                      "example": "DemonWaves",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "New session created and user added to database."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/authentication/login",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/body/authenticationCode",
                            "type": "string"
                          },
                          "message": {
                            "example": "authenticationCode cannot be empty",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.loginBodyValidator.authenticationCode.empty",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication code."
          }
        },
        "security": [],
        "summary": "Authentication callback from osu!",
        "tags": [
          "Authentication"
        ]
      }
    },
    "/authentication/logout": {
      "post": {
        "description": "This endpoint destroy any session associated with the request and effectively\nlogs out the user.\n",
        "operationId": "logout",
        "responses": {
          "204": {
            "description": "Any session associated with the request has been destroyed."
          }
        },
        "security": [],
        "summary": "Destroy session and log out.",
        "tags": [
          "Authentication"
        ]
      }
    },
    "/matches": {
      "post": {
        "description": "Creates a new match. This will ask bancho to create a new multiplayer channel\nand return the channel details for later use.\n",
        "operationId": "createMatch",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "name": {
                    "type": "string"
                  }
                },
                "required": [
                  "name"
                ],
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "gameMatchId": {
                      "example": 119065801,
                      "type": "integer"
                    },
                    "name": {
                      "example": "MWC4K2025 RO32: Philippines VS France",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "New match created and channel opened on bancho."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/body/name",
                            "type": "string"
                          },
                          "message": {
                            "example": "name cannot be empty",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.createMatchBodyValidator.name.empty",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid name."
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches",
                      "type": "string"
                    },
                    "status": {
                      "example": 401,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Unauthorized",
                      "type": "string"
                    },
                    "detail": {
                      "example": "You must be authenticated to access this resource.",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication."
          }
        },
        "security": [
          {
            "cookie": []
          }
        ],
        "summary": "Create a new match.",
        "tags": [
          "Matches"
        ]
      }
    },
    "/matches/{gameMatchId}": {
      "get": {
        "description": "Get an existing match by its bancho channel id.\n",
        "operationId": "getMatch",
        "parameters": [
          {
            "in": "path",
            "name": "gameMatchId",
            "schema": {
              "type": "integer"
            },
            "required": true,
            "description": "The bancho ID of the match to get."
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "endsAt": {
                      "example": "2025-08-24T13:07:27Z",
                      "format": "date-time",
                      "nullable": true,
                      "type": "string"
                    },
                    "gameMatchId": {
                      "example": 119065801,
                      "type": "integer"
                    },
                    "name": {
                      "example": "MWC4K2025 RO32: Philippines VS France",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Match related data."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/random-string",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/params/gameMatchId",
                            "type": "string"
                          },
                          "message": {
                            "example": "gameMatchId must be a positive integer string",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.getMatchParametersValidator.gameMatchId.integer",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid gameMatchId."
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/119065801",
                      "type": "string"
                    },
                    "status": {
                      "example": 401,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Unauthorized",
                      "type": "string"
                    },
                    "detail": {
                      "example": "You must be authenticated to access this resource.",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication."
          }
        },
        "security": [
          {
            "cookie": []
          }
        ],
        "summary": "Get an existing match.",
        "tags": [
          "Matches"
        ]
      }
    },
    "/matches/{gameMatchId}/chat-history": {
      "get": {
        "description": "Get the chat history of a given match up to this point in time.\n\nBear in mind that this data is temporarily stored in Redis while the match is ongoing.\nSince it doesn't serve any other purpose than allowing referees to run matches, it is\ndeleted on match closure.\n",
        "operationId": "getMatchChatHistory",
        "parameters": [
          {
            "in": "path",
            "name": "gameMatchId",
            "schema": {
              "type": "integer"
            },
            "required": true,
            "description": "The bancho ID of the match to get the chat history for."
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "properties": {
                      "message": {
                        "properties": {
                          "author": {
                            "example": "DemonWaves",
                            "type": "string"
                          },
                          "content": {
                            "example": "Hello everyone, welcome to the match!",
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "timestamp": {
                        "example": "2025-10-05T00:31:21Z",
                        "format": "date-time",
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                }
              }
            },
            "description": "Chat history of an the ongoing given match."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/random-string/chat-history",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/params/gameMatchId",
                            "type": "string"
                          },
                          "message": {
                            "example": "gameMatchId must be a positive integer string",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.getMatchChatParametersValidator.gameMatchId.integer",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid gameMatchId."
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/119065801/chat-history",
                      "type": "string"
                    },
                    "status": {
                      "example": 401,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Unauthorized",
                      "type": "string"
                    },
                    "detail": {
                      "example": "You must be authenticated to access this resource.",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication."
          }
        },
        "security": [
          {
            "cookie": []
          }
        ],
        "summary": "Get chat history of an ongoing match.",
        "tags": [
          "Matches"
        ]
      }
    },
    "/matches/{gameMatchId}/close": {
      "post": {
        "description": "Closes an existing match. This will also ask bancho to close the multiplayer channel\nassociated with it.\n",
        "operationId": "closeMatch",
        "parameters": [
          {
            "in": "path",
            "name": "gameMatchId",
            "schema": {
              "type": "integer"
            },
            "required": true,
            "description": "The bancho ID of the match to close."
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "status": {
                      "example": "closed",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Match and bancho channel closed."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/random-string/close",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/params/id",
                            "type": "string"
                          },
                          "message": {
                            "example": "gameMatchId must be a positive integer string",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.closeMatchParametersValidator.gameMatchId.integer",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid id."
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/119065801/close",
                      "type": "string"
                    },
                    "status": {
                      "example": 401,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Unauthorized",
                      "type": "string"
                    },
                    "detail": {
                      "example": "You must be authenticated to access this resource.",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication."
          }
        },
        "security": [
          {
            "cookie": []
          }
        ],
        "summary": "Close an existing match.",
        "tags": [
          "Matches"
        ]
      }
    },
    "/matches/{gameMatchId}/state": {
      "get": {
        "description": "Get the current lobby state of an ongoing match.\n\nBear in mind that this data is temporarily stored in Redis while the match is ongoing.\nSince it doesn't serve any other purpose than allowing referees to run matches, it is\ndeleted on match closure.\n",
        "operationId": "getMatchState",
        "parameters": [
          {
            "in": "path",
            "name": "gameMatchId",
            "schema": {
              "type": "integer"
            },
            "required": true,
            "description": "The bancho ID of the match to get the lobby state for."
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "globalModifications": {
                      "type": "array",
                      "items": {
                        "example": "DoubleTime",
                        "type": "string"
                      }
                    },
                    "playerCount": {
                      "example": 1,
                      "type": "integer"
                    },
                    "slots": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "isHost": {
                            "example": false,
                            "type": "boolean"
                          },
                          "isReady": {
                            "example": true,
                            "type": "boolean"
                          },
                          "player": {
                            "type": "string",
                            "example": "DemonWaves",
                            "nullable": true
                          },
                          "selectedModifications": {
                            "type": "array",
                            "items": {
                              "example": "HardRock",
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "activeBeatmap": {
                      "type": "object",
                      "nullable": true,
                      "properties": {
                        "name": {
                          "example": "Glamour Of The Kill - A Hope In Hell",
                          "type": "string"
                        },
                        "url": {
                          "example": "https://osu.ppy.sh/b/2855263",
                          "type": "string"
                        }
                      }
                    },
                    "historyUrl": {
                      "example": "https://osu.ppy.sh/community/matches/86727666",
                      "nullable": true,
                      "type": "string"
                    },
                    "name": {
                      "example": "MFT4K2021 LR1: (DemonWaves) vs (FilsDeLama)",
                      "nullable": true,
                      "type": "string"
                    },
                    "teamMode": {
                      "example": "HeadToHead",
                      "nullable": true,
                      "type": "string"
                    },
                    "winCondition": {
                      "example": "ScoreV2",
                      "nullable": true,
                      "type": "string"
                    }
                  }
                }
              }
            },
            "description": "Lobby state of an the ongoing given match."
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/random-string/state",
                      "type": "string"
                    },
                    "status": {
                      "example": 400,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Bad Request",
                      "type": "string"
                    },
                    "detail": {
                      "example": "Input validation failed",
                      "type": "string"
                    },
                    "errors": {
                      "items": {
                        "properties": {
                          "path": {
                            "example": "/params/gameMatchId",
                            "type": "string"
                          },
                          "message": {
                            "example": "gameMatchId must be a positive integer string",
                            "type": "string"
                          },
                          "errorCode": {
                            "example": "validator.getMatchStateParametersValidator.gameMatchId.integer",
                            "type": "string"
                          }
                        }
                      }
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid gameMatchId."
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "instance": {
                      "example": "/api/v1/matches/119065801/state",
                      "type": "string"
                    },
                    "status": {
                      "example": 401,
                      "type": "integer"
                    },
                    "title": {
                      "example": "Unauthorized",
                      "type": "string"
                    },
                    "detail": {
                      "example": "You must be authenticated to access this resource.",
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              }
            },
            "description": "Missing or invalid authentication."
          }
        },
        "security": [
          {
            "cookie": []
          }
        ],
        "summary": "Get lobby state of an ongoing match.",
        "tags": [
          "Matches"
        ]
      }
    },
    "/public/health": {
      "get": {
        "description": "This allows to check if the server is up and running.\nHelpful if you want to check API status before making any request.\n",
        "operationId": "getHealth",
        "responses": {
          "200": {
            "content": {
              "plain/text": {
                "schema": {
                  "example": "OK",
                  "type": "string"
                }
              }
            },
            "description": "For now, it only tells that the API is up and running."
          }
        },
        "security": [],
        "summary": "Check server systems status.",
        "tags": [
          "Public"
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "cookie": {
        "type": "apiKey",
        "in": "cookie",
        "name": "sessionId"
      }
    }
  }
}