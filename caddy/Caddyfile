{
	admin :2019
}

dev.osu-tournament-manager.app {
  @appWebSockets {
		path /api/websockets/*
		header Connection *Upgrade*
		header Upgrade websocket
	}

	@viteWebSockets {
		path /@vite/*
		header Connection *Upgrade*
		header Upgrade websocket
	}

	encode gzip

	handle @appWebSockets {
		uri strip_prefix /api
		reverse_proxy server:{$SERVER_PORT_CONTAINER}
	}

  handle /api/* {
    reverse_proxy server:{$SERVER_PORT_CONTAINER}
  }

	handle @viteWebSockets {
		uri strip_prefix /api
		reverse_proxy client:{$CLIENT_PORT_CONTAINER}
	}

	header -Server
	header -Via

  reverse_proxy client:{$CLIENT_PORT_CONTAINER}
	tls internal
}
